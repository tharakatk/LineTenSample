# LineTen.Analytics

Write a description of what your project does here.

## Prerequisites

- dotnet cli

## Running the project

In Visual Studio 2019 - ensure you set the docker-compose project as the startup project, otherwise you will get database connection errors.

You may set the LineTen.Analytics.Api project as startup if you are hosting your own local services.

## Rules

You MUST use the following keywords when describing requirements in code - https://www.ietf.org/rfc/rfc2119.txt and capitilize the usage of these key words

You MUST ensure that compiler warnings are absent, observing the following rules and exceptions:

* You MUST not suppress warnings other than 1701;1702 in main project files.
* Suppression of 1701;1702;CS1591;IDE1006 is permitted in test projects.
* Suppression of all warnings is permitted in generated code classes
* All tests MUST pass in both Visual Studio and during the Docker build (see below)
* YOU MUST ensure that warnings generated by the .editorconfig file via Visual Studio are fixed.

YOU MUST be using an editor that supports .editorconfig (e.g. vscode and vs2019)

### Unit Testing

* Tests MUST be written - we use https://www.nuget.org/packages/LineTen.Unit.Tests.Framework - see the readme when installing the package on usage
* Unit tests MUST be placed in a namespace/folder structure that mirrors the location in the target assembly (see when_creating_a_new_weather_forecast.cs)
* Unit tests SHOULD be structured in the given/when/then when/it/should in place of the traditional arrange act assert language, see when_creating_a_new_weather_forecast.cs for an example.
* Unit tests SHOULD use the WithSubject helper where possible to aid automatic mocking of dependencies. Use the The<> method to access mocks, or the With<> method to provide instances of dependencies before acting on the Subject

### Integration Testing

* Integration tests SHOULD be written - we use https://www.nuget.org/packages/LineTen.Integration.Tests.Framework - see the readme when installing the package on how to use.

## Database Migrations

Change directory to `src\LineTen.Analytics.Data`

`dotnet ef migrations add "your migration name"`

`dotnet ef database update`

`dotnet ef migrations remove -f`

If you want to change database provider - i.e from MySql to something else, first make sure you remove references to `.UseMySql(..)` and swap to your preferred provider, then remove all files from the `Migrations` including the snapshot and recreate the initial migration using the first command above

## Additional projects

E.g. If you wish to add a UI project to this repository, create another director in the root called `ui` and place you `Docker` file in there.

Modify the `docker-compose.yml` file to build that docker file as appropriate

If you have additional back end services that you'd like to host, create those new back end projects in the `src` folder.

## Docker images

run `docker-compose up` in the root folder to start the application.

Instruct you CI pipeline to use the `Dockerfile.tests` file to allow extraction of test results and code coverage.

From the root folder run:

`docker build src -f src/LineTen.Analytics.Api/Dockerfile.tests`

You can also run:

`docker build src -f src/LineTen.Analytics.Api/Dockerfile`

to skip tests and just build the image.
